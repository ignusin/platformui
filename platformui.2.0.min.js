var PlatformUI={};!function(e){e.version="2.0.0-beta",e.body=function(){return document.body},e.element=function(e){if("undefined"!=typeof e)if("string"==typeof e){if(e.length>0)return document.getElementById("#"!==e[0]?e:e.substring(1))}else{if(e instanceof jQuery&&e.length>0)return e[0];if("undefined"!=typeof e.tagName)return e;if("undefined"!=typeof e.getElement)return e.getElement()}throw"Invalid argument"},e.ns=function(e){var t,n=e.split("."),i=window;for(t=0;t<n.length;++t)i[n[t]]||(i[n[t]]={}),i=i[n[t]];return i},e.inherit=function(t,n,i){var a=function(){};a.prototype=t.prototype,n.prototype=new a,n.prototype.constructor=n,n.super=t.prototype,i&&e.extend(n,i)},e.extend=function(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e.prototype[n]=t[n])},e.apply=function(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e.undefined=function(e){return"undefined"==typeof e},e.value=function(e,t){var n,i=t.split(".");for(n=0;n<i.length;++n)e=e[i[n]];return e},e.setValue=function(e,t,n){var i,a=t.split(".");for(i=0;i<a.length;++i)i<a.length-1?(e[a[i]]||(e[a[i]]={}),e=e[a[i]]):e[a[i]]=n}}(PlatformUI),function(e){e.createElement=function(e){return document.createElement(e)},e.createText=function(e){return document.createTextNode(e)},e.htmlToJQuery=function(e){return $($.trim(e))},e.appear=function(e,t){t?t.duration=200:t={duration:200},$(e).fadeIn(t)},e.disappear=function(e,t){t?t.duration=200:t={duration:200},$(e).fadeOut(t)},e._nextZIndex=1e3,e.nextZIndex=function(){return e._nextZIndex++},e._idSequence=1,e.nextId=function(){return"element_"+(e._idSequence++).toString()},e.redirect=function(e){window.location.href=e},e.SortDirection={Ascending:0,Descending:1},e.hasPagingArgs=function(e){return e&&e.index>0&&e.size>0},e.hasSortingArgs=function(e){return e&&e.column},e.QueryStringSerializer=function(){this._result=""},e.QueryStringSerializer.prototype={append:function(e,t){""!==this._result&&(this._result+="&"),this._result+=e,this._result+="=",this._result+=encodeURIComponent(t)},toString:function(){return this._result}},e.serialize=function(t){var n,i=new e.QueryStringSerializer;for(n in t)i.append(n,t[n]);return i.toString()},e._zeroPad=function(e,t){if(e=e.toString(),e.length<t)for(var n=t-e.length,i=0;n>i;++i)e="0"+e;return e},e.today=function(){var e=new Date;return new Date(e.getFullYear(),e.getMonth(),e.getDate())},e.compareDates=function(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()},e.formatDate=function(t){var n=e._zeroPad(t.getDate(),2)+"."+e._zeroPad(t.getMonth()+1,2)+"."+e._zeroPad(t.getFullYear(),4);return n},e.formatDateTime=function(t,n){var i=e._zeroPad(t.getDate(),2)+"."+e._zeroPad(t.getMonth()+1,2)+"."+e._zeroPad(t.getFullYear(),4)+", "+e._zeroPad(t.getHours(),2)+":"+e._zeroPad(t.getMinutes(),2);return n!==!1&&(i+=":"+e._zeroPad(t.getSeconds(),2)),i},e.parseDate=function(e){var t=parseInt(e.substr(0,2)),n=parseInt(e.substr(3,2)),i=parseInt(e.substr(6,4)),a=new Date(i,n-1,t);return a},e.parseDateTime=function(e){var t=parseInt(e.substr(0,2)),n=parseInt(e.substr(3,2)),i=parseInt(e.substr(6,4)),a=parseInt(e.substr(12,2)),o=parseInt(e.substr(15,2)),r=parseInt(e.substr(18,2)),s=new Date(i,n-1,t,a,o,r);return s},e.shortenText=function(e,t){return e?e.length<t?e:e.substr(0,t)+"...":e},e.setMultilineText=function(t,n){var i=$(e.element(t));i.text(n),i.html(i.html().replace(/\n/g,"<br/>"))}}(PlatformUI),function(e){e.Locale={weekNames:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],weekNamesFull:["Воскресение","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"],monthNames:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"]}}(PlatformUI),function(e){e.remoteMarkup=function(e,t){var n={type:t||"GET",dataType:"html"},i=$.Deferred();return $.ajax(e,n).done(function(e){i.resolve(e)}).fail(function(){i.reject()}),i},e.remoteScript=function(e,t){var n={type:t||"GET",dataType:"script"},i=$.Deferred();return $.ajax(e,n).done(function(){i.resolve()}).fail(function(){i.reject()}),i},e.remoteData=function(e,t,n,i){var a={type:n||"POST",data:t,dataType:"text"};i&&(a.contentType=i);var o=$.Deferred();return $.ajax(e,a).done(function(e){o.resolve(e)}).fail(function(){o.reject()}),o},e.remoteJSON=function(e,t,n){var i={type:n||"POST",data:JSON.stringify(t),dataType:"json",contentType:"application/json"},a=$.Deferred();return $.ajax(e,i).done(function(e){a.resolve(e)}).fail(function(){a.reject()}),a},e.remoteIframe=function(t,n){function i(){var t=e._iframeActiveRequests[r.id],n=o.contentDocument,i=n.body.textContent;delete e._iframeActiveRequests[r.id],t.resolve(i)}function a(){var t;if(r.id){if(e._iframeActiveRequests[r.id])throw"Active request in progress."}else r.id=e.nextId();if(r.target)t=e.element(r.target);else{var a=e.nextId();t=document.createElement("iframe"),t.id=a,t.name=a,t.style.width=0,t.style.height=0,t.frameBorder=0,document.body.appendChild(t),r.target=a}r.method="POST",r.action=n;var s=!1;null===t.onreadystatechange?t.onreadystatechange=function(){s||!this.readyState||"loaded"!==this.readyState&&"complete"!==this.readyState||(s=!0,i())}:t.onload=i,o=t}var o,r=e.element(t);if(a(),e._iframeActiveRequests[r.id])throw"Active request in progress.";var s=$.Deferred();return e._iframeActiveRequests[r.id]=s,r.submit(),s},e._iframeActiveRequests={}}(PlatformUI),function(e){e.LocalDataSource=function(e){this._data=e,this._filterDataHandler=null},e.LocalDataSource.prototype={_fireOnFilterData:function(e,t,n){return this._filterDataHandler?this._filterDataHandler(e,t,n):e},setOnFilterData:function(e){this._filterDataHandler=e},_createSortFunction:function(t,n){return n===e.SortDirection.Ascending?function(e,n){return e[t]<n[t]?-1:e[t]>n[t]?1:0}:function(e,n){return e[t]<n[t]?1:e[t]>n[t]?-1:0}},read:function(t,n,i,a,o){var r,s=this._data,l={count:-1,data:s};if((o&&Object.keys(o).length>0||a&&Object.keys(a).length>0)&&(s=this._fireOnFilterData(s,a,o)),e.hasSortingArgs(i)){var d=new Array(s.length);for(r=0;r<s.length;++r)d[r]=s[r];d.sort(this._createSortFunction(i.column,i.direction)),s=d}if(e.hasPagingArgs(n)){var h=new Array(n.size),c=(n.index-1)*n.size,u=n.index*n.size;for(r=c;u>r;++r)h[r-c]=s[r];l.count=s.length,s=h}l.data=s,t.call(this,l)}},e.RequestFormat={Json:"json",Post:"post"},e.RemoteDataSource=function(t,n){this._events={prepareRequest:[],prepareResponse:[]},this._readUrl=t,this._requestFormat="undefined"==typeof n?e.RequestFormat.Json:n},e.RemoteDataSource.prototype={_onRequestSuccess:function(t,n){var i;i=this._requestFormat===e.RequestFormat.Post?JSON.parse(t):t,this.prepareResponse({data:i}),n(i)},prepareResponse:function(e){this._fireOnPrepareResponse(e)},_fireOnPrepareRequest:function(e){var t;for(t=0;t<this._events.prepareRequest.length;++t)this._events.prepareRequest[t](e)},_fireOnPrepareResponse:function(e){var t;for(t=0;t<this._events.prepareResponse.length;++t)this._events.prepareResponse[t](e)},onPrepareRequest:function(e){this._events.prepareRequest.push(e)},onPrepareResponse:function(e){this._events.prepareResponse.push(e)},read:function(t,n,i,a,o){var r={pageIndex:0,pageSize:0,sortColumn:"",sortDirection:e.SortDirection.Ascending};if(e.hasPagingArgs(n)&&(r.pageIndex=n.index,r.pageSize=n.size),e.hasSortingArgs(i)&&(r.sortColumn=i.column,r.sortDirection=i.direction),o&&e.apply(r,o),a){var s,l={};for(s in a)a[s]&&(l[s]=a[s]);r.filter=JSON.stringify(l)}this._fireOnPrepareRequest({data:r});var d;if(this._requestFormat===e.RequestFormat.Json)d=e.remoteJSON(this._readUrl,r);else{var h=e.serialize(r);d=e.remoteData(this._readUrl,h)}var c=this;d.done(function(e){c._onRequestSuccess(e,t)})}}}(PlatformUI),function(e){e.getInputValue=function(t){return t=e.element(t),"input"===t.tagName.toLowerCase()&&"checkbox"===t.type.toLowerCase()?t.checked:t.value},e.setInputValue=function(t,n){t=e.element(t),"input"===t.tagName.toLowerCase()&&"checkbox"===t.type.toLowerCase()?t.checked=n?!0:!1:t.value=void 0===n||null===n?"":n},e.resetInputValue=function(t){t=e.element(t),"input"===t.tagName.toLowerCase()&&"checkbox"===t.type.toLowerCase()?t.checked=!1:t.value=""},e.setInputEnabled=function(t,n){e.element(t).disabled=!n},e.getInputEnabled=function(t){return!e.element(t).disabled},e.hasSelectItems=function(e){var t=$("option",e).length;return t>0},e.selectFirstItem=function(e){var t=$("option",e);t.length>0&&(e.selectedIndex=0)},e.fillSelectList=function(t,n,i,a,o){var r=e.element(t);$(r).empty();var s,l,d,h;if(o)for(l=0;l<o.length;++l)s=o[l],d=e.createElement("option"),d.value=s.value,h=e.createText(s.text),d.appendChild(h),r.appendChild(d);for(l=0;l<n.length;++l)s=n[l],d=e.createElement("option"),d.value="function"==typeof a?a(s):e.value(s,a),h=e.createText("function"==typeof i?i(s):e.value(s,i)),d.appendChild(h),r.appendChild(d)},e.FormObserver=function(t){this._fields={},this._enabled={},this._form=e.element(t),this._initObserver()},e.FormObserver.prototype={_initObserver:function(){var t,n,i=this;for(t=0;t<this._form.length;++t)n=this._form.elements[t],n.addEventListener("change",function(e){i._input_OnChange(e)}),this._fields[n.name]=e.getInputValue(n),this._enabled[n.name]=!n.disabled},_input_OnChange:function(t){this._fields[t.target.name]=e.getInputValue(t.target)},_updateFieldsData:function(){var t,n;for(t=0;t<this._form.length;++t)n=this._form.elements[t],this._fields[n.name]=e.getInputValue(n)},reset:function(){this._form.reset();var t,n;for(t=0;t<this._form.length;++t)n=this._form.elements[t],e.resetInputValue(n),this._fields[n.name]=""},getElement:function(){return this._form},setValue:function(t,n){var i,a;for(i=0;i<this._form.length;++i)if(a=this._form.elements[i],a.name===t)return e.setInputValue(a,n),void(this._fields[t]=n)},getValue:function(e){return this._fields[e]},getInputElement:function(e){return this._form[e]},isEnabled:function(e){return this._enabled[e]},setEnabled:function(e,t){var n,i;for(n=0;n<this._form.length;++n)if(i=this._form.elements[n],i.name===e)return i.disabled=!t,void(this._enabled[e]=t)},setFormEnabled:function(e){var t,n;for(t=0;t<this._form.length;++t)n=this._form.elements[t],n.disabled=!e,this._enabled[n.name]=e},getData:function(){return this._updateFieldsData(),this._fields},serialize:function(){return this.getSerializer().toString()},getSerializer:function(){var t,n=new e.QueryStringSerializer,i=this.getData();for(t in i)n.append(t,i[t]);return n},setData:function(t){var n,i;for(n in t)for(i=0;i<this._form.length;++i)if(n===this._form.elements[i].name){e.setInputValue(this._form.elements[i],t[n]),this._fields[n]=t[n];break}}}}(PlatformUI),function(e){e.RequiredValidator=function(){},e.RequiredValidator.prototype={validate:function(e){return e?!0:!1}},e.IntegerFormatValidator=function(){},e.IntegerFormatValidator.prototype={validate:function(e){var t;for(t=0;t<e.length;++t)if(e[t]<"0"||e[t]>"9")return!1;return!0}},e.FloatFormatValidator=function(){},e.FloatFormatValidator.prototype={validate:function(e){if(!e)return!0;var t=parseFloat(e);return!isNaN(t)}},e.EmailFormatValidator=function(){},e.EmailFormatValidator.prototype={validate:function(e){return/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(e)}},e.FormValidator=function(t){this._form=e.element(t),this._container=null,this._fieldRules={},this._validatorsVisible=!1,this._enabled=!0,this._initValidators()},e.FormValidator.prototype={_initValidators:function(){this._container=$("<div></div>"),this._container.addClass("PlatformUI-Control PlatformUI-Validator-Container"),$(e.body()).append(this._container);var t=this;e.body().addEventListener("click",function(){t._body_OnClick()},!0)},_showValidator:function(t,n,i){t.text(i);var a=n.offset(),o=n.width()+a.left,r=a.top;t.css({"z-index":e.nextZIndex(),left:o,top:r,position:"absolute"}),e.appear(t),this._validatorsVisible=!0},_validateFieldRule:function(t,n,i,a){return i.validator.validate(e.getInputValue(n))?!0:(a&&this._showValidator(t,$(n),i.message),!1)},_body_OnClick:function(){if(this._validatorsVisible){var t,n;for(t in this._fieldRules)n=this._fieldRules[t],n.validator.is(":visible")&&e.disappear(n.validator);this._validatorsVisible=!1}},addFieldRule:function(e,t){var n={validator:t.validator,message:t.message,enabled:!0};if(this._fieldRules[e])this._fieldRules[e].rules.push(n);else{var i=this._form[e],a=$("<div></div>");a.addClass("PltformUI-Control PlatformUI-FieldValidator"),a.hide(),this._container.append(a),this._fieldRules[e]={validator:a,input:i,rules:[n]}}},showMessage:function(e,t){var n=this._fieldRules[e];this._showValidator(n.validator,n.input,t)},enableFieldRules:function(e,t){var n,i=this._fieldRules[e];for(n=0;n<i.rules.length;++n)i.rules[n].enabled=t},setEnabled:function(e){this._enabled=e},_validate:function(e){if(!this._enabled)return!0;var t,n,i,a,o=!0;for(t in this._fieldRules){for(n=this._fieldRules[t],a=!0,i=0;i<n.rules.length&&(!n.rules[i].enabled||(a=this._validateFieldRule(n.validator,n.input,n.rules[i],e),a));++i);a||(o=!1)}return o},validate:function(){return this._validate(!0)},isValid:function(){return this._validate(!1)}},e.ValidationMessage=function(t){this._el=$(e.element(t)),this._validatorEl=null,this._validatorVisible=!1,this._initValidators()},e.extend(e.ValidationMessage,{_initValidators:function(){this._validatorEl=$("<div></div>"),this._validatorEl.addClass("PlatformUI-Control PlatformUI-ElementValidator"),this._validatorEl.css({display:"none"}),$(e.body()).append(this._validatorEl);var t=this;e.body().addEventListener("click",function(){t._body_OnClick()},!0)},_showValidator:function(t){this._validatorEl.empty(),this._validatorEl.text(t);var n=this._el.offset(),i=this._el.width()+n.left,a=n.top;this._validatorEl.css({"z-index":e.nextZIndex(),left:i,top:a,position:"absolute"}),e.appear(this._validatorEl),this._validatorVisible=!0},_body_OnClick:function(){this.hide()},hide:function(){this._validatorVisible&&(this._validatorEl.css({display:"none"}),this._validatorVisible=!1)},showMessage:function(e){this._showValidator(e)}})}(PlatformUI),function(e){e.WaitArea=function(){this._el=$(e.body()),this._backgroundEl=null,this._waitEl=null,this._toShow=!1,this._init()},e.WaitArea.prototype={_init:function(){var t=this,n=$("<div></div>");n.addClass("PlatformUI-WaitArea-Background"),n.css({display:"none"});var i=$("<div></div>");i.addClass("PlatformUI-Control"),i.addClass("PlatformUI-WaitArea"),i.text("Ожидайте, выполняется запрос"),i.css({display:"none"});var a=$(e.body());a.append(n),a.append(i),t._backgroundEl=n,t._waitEl=i},_show:function(){var t=this;t._toShow&&(t._backgroundEl.css({"z-index":e.nextZIndex()}),t._backgroundEl.css({position:"fixed",left:"0",top:"0",right:"0",bottom:"0","margin-left":"0","margin-top":"0","margin-right":"0","margin-bottom":"0",width:"100%",height:"100%"}),t._waitEl.css({"z-index":e.nextZIndex(),position:"fixed",left:"50%",top:"50%",right:"auto",bottom:"auto"}),e.appear(t._backgroundEl),e.appear(t._waitEl,{start:function(){t._waitEl.css({"margin-left":-t._waitEl.width()/2+"px","margin-top":-t._waitEl.height()/2+"px","margin-right":"0","margin-bottom":"0"})}}))},show:function(){var e=this;e._toShow=!0,e._show()},hide:function(){var t=this;e.disappear(t._waitEl),e.disappear(t._backgroundEl),t._toShow=!1},toDataBoundControl:function(e){var t=this;e.onDataBinding(function(){t.show()}),e.onDataBound(function(){t.hide()})}}}(PlatformUI),function(e){e.Button=function(t){this._el=$(t?e.element(t):'<a href="javascript:void(0)"></a>'),this._pushed=!1,this._enabled=!0,this._pushedExt=!1,this._events={click:[]},this._initControl()},e.Button.prototype={_initControl:function(){var e=this;this._el.addClass("PlatformUI-Control PlatformUI-Button"),this._el.mousedown(function(){e._enabled&&!e._pushedExt&&(e._el.addClass("Pushed"),e._pushed=!0)}),this._el.mouseup(function(){e._enabled&&!e._pushedExt&&(e._el.removeClass("Pushed Over"),e._pushed=!1)}),this._el.mouseover(function(){e._pushed||!e._enabled||e._pushedExt||e._el.addClass("Over")}),this._el.mouseout(function(){e._enabled&&!e._pushedExt&&(e._el.removeClass("Pushed Over"),e._pushed&&(e._pushed=!1))}),this._el.click(function(){e._enabled&&e._fireOnClickEvent()})},_fireOnClickEvent:function(){var e;for(e=0;e<this._events.click.length;++e)this._events.click[e](this._el)},onClick:function(e){this._events.click.push(e)},setEnabled:function(e){e?this._el.removeClass("Disabled"):this._el.addClass("Disabled"),this._enabled=e},isEnabled:function(){return this._enabled},setPushed:function(e){this._pushedExt=e,this._pushedExt?this._el.addClass("Pushed"):this._el.removeClass("Pushed")},isPushed:function(){return this._pushedExt},setText:function(e){var t=this._el.prop("tagName").toUpperCase();"A"===t?this._el.text(e):"INPUT"===t&&this._el.attr("value",e)},getText:function(){var e=this._el.prop("tagName").toUpperCase();return"A"===e?this._el.text():"INPUT"===e?this._el.attr("value"):null},getElement:function(){return this._el}}}(PlatformUI),function(e){e.Calendar=function(t){this._element=$(t?e.element(t):"<div></div>"),this._selectedDate=null,this._currentYear=null,this._currentMonth=null,this._headerEl=null,this._bodyEl=null,this._yearLabel=null,this._monthDdl=null,this._startDayOfWeek=1,this._events={selectedDateChanged:[]},this._initCurrentDate(),this._initControl(),this._updateYearLabel(),this._updateMonthDdl(),this._recreateMonthView()},e.Calendar.prototype={_initCurrentDate:function(){var e=this,t=new Date;e._currentYear=t.getFullYear(),e._currentMonth=t.getMonth(),e._selectedDate=t},_initControl:function(){var e=this;e._createHeaderControls();var t=$('<div class="PlatformUI-Body"></div>');e._bodyEl=t,e._element.addClass("PlatformUI-Control"),e._element.addClass("PlatformUI-Calendar"),e._element.append(e._headerEl),e._element.append(e._bodyEl)},_createHeaderControls:function(){var t=this,n=$('<div class="PlatformUI-Header"></div>'),i=$('<select class="PlatformUI-MonthList"></select>');i.change(function(){t._monthDdl_Change()});var a,o,r;for(a=0;12>a;++a)o=e.createElement("option"),r=e.createText(e.Locale.monthNames[a]),o.appendChild(r),i.append(o);n.append(i);var s=$('<a href="javascript:void(0)" class="PlatformUI-PrevYearButton">&lt;&lt;</a>');s.click(function(){t._prevYearButton_Click()}),n.append(s);var l=$('<span class="PlatformUI-YearLabel"></span>');n.append(l);var d=$('<a href="javascript:void(0)" class="PlatformUI-NextYearButton">&gt;&gt;</a>');d.click(function(){t._nextYearButton_Click()}),n.append(d),t._headerEl=n,t._yearLabel=l,t._monthDdl=i},_updateYearLabel:function(){var e=this;e._yearLabel.text(e._currentYear.toString())},_updateMonthDdl:function(){var e=this;e._monthDdl.prop("selectedIndex",e._currentMonth)},_daysInMonth:function(e,t){return new Date(e,t+1,0).getDate()},_firstWeekDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_recreateMonthView:function(){var e=this;e._bodyEl.empty();var t=$('<table class="PlatformUI-MonthView"></table>'),n=$("<thead></thead>");t.append(n);var i=$("<tbody></tbody>");t.append(i),e._createHeaderRow(n),e._createMonthViewRows(i),e._bodyEl.append(t)},_createHeaderRow:function(t){var n,i,a=this,o=$("<tr></tr>"),r=a._startDayOfWeek;for(n=0;7>n;++n)i=$("<th></th>"),i.text(e.Locale.weekNames[r%7]),o.append(i),++r;t.append(o)},_createMonthViewRows:function(e){var t=this,n=t._daysInMonth(t._currentYear,t._currentMonth),i=(t._firstWeekDayOfMonth(t._currentYear,t._currentMonth)-t._startDayOfWeek)%7;0>i&&(i+=7);var a,o,r,s,l,d=Math.ceil((n+i)/7),h=0;for(a=0;d>a;++a){for(r=$("<tr></tr>"),o=0;7>o;++o)s=$("<td></td>"),h>=i&&n+i>h?(l=h-i+1,s.text(l.toString()),l===t._selectedDate.getDate()&&t._currentMonth===t._selectedDate.getMonth()&&t._currentYear===t._selectedDate.getFullYear()&&s.addClass("PlatformUI-Selected"),s.click(function(e,n){return function(){t._date_Click(e,n)}}(s,l))):s.addClass("PlatformUI-Inactive"),r.append(s),++h;e.append(r)}},_monthDdl_Change:function(){var e=this;e._currentMonth=e._monthDdl.prop("selectedIndex"),e._recreateMonthView()},_prevYearButton_Click:function(){var e=this;1900!==e._currentYear&&(--e._currentYear,e._updateYearLabel(),e._recreateMonthView())},_nextYearButton_Click:function(){var e=this;2100!==e._currentYear&&(++e._currentYear,e._updateYearLabel(),e._recreateMonthView())},_date_Click:function(e,t){var n=this,i=$(".PlatformUI-Selected",n._bodyEl);i&&i.removeClass("PlatformUI-Selected"),e.addClass("PlatformUI-Selected"),n._selectedDate=new Date(n._currentYear,n._currentMonth,t),n._fireOnSelectedDateChanged()},_fireOnSelectedDateChanged:function(){var e,t=this;for(e=0;e<t._events.selectedDateChanged.length;++e)t._events.selectedDateChanged[e]()},onSelectedDateChanged:function(e){var t=this;t._events.selectedDateChanged.push(e)},setSelectedDate:function(e){var t=this,n=e.getFullYear();1900>n||n>2100||(t._selectedDate=e,t._currentYear=n,t._currentMonth=e.getMonth(),t._updateYearLabel(),t._updateMonthDdl(),t._recreateMonthView())},getSelectedDate:function(){var e=this;return e._selectedDate},getElement:function(){var e=this;return e._element}}}(PlatformUI),function(e){e.MessageDialog=function(){this._title=null,this._text=null,this._closeButton=null,this._dialog=null,this._events={close:[]},this._closeDefault=!0,this._init()},e.MessageDialog.prototype={_init:function(){var t=this,n=$("<div></div>"),i=new e.Button;i.setText("ОК"),i.onClick(function(){t._onClose()});var a=new e.Dialog;a.setContentElement(n),a.addCommandElement(i),this._dialog=a,this._text=n,this._closeButton=i},_onClose:function(){var e;for(e=0;e<this._events.close.length;++e)this._events.close[e]();this.isCloseDefault()&&this.hide()},setTitle:function(e){this._dialog.setTitle(e)},getTitle:function(){return this._dialog.getTitle()},setText:function(e){this._text.html(e)},getText:function(){return this._text.html()},setCloseButtonText:function(e){this._closeButton.setText(e)},getCloseButtonText:function(){return this._closeButton.getText()},setCloseDefault:function(e){this._closeDefault=e},isCloseDefault:function(){return this._closeDefault},onClose:function(e){this._events.close.push(e)},show:function(){this._dialog.show()},hide:function(){this._dialog.hide()}}}(PlatformUI),function(e){e.DatePicker=function(t){this._el=$(t?e.element(t):"<div></div>"),this._calendar=null,this._dropDown=null,this._events={selectedDateChanged:[]},this._initControl()},e.DatePicker.prototype={_initControl:function(){var t=this,n=$("<div></div>");t._calendar=new e.Calendar(n),t._calendar.onSelectedDateChanged(function(){t._calendar_selectedDateChanged()});var i=new Date;t._dropDown=new e.DropDown(t._el,n),t._dropDown.setText(e.formatDate(i))},_calendar_selectedDateChanged:function(){var t=this;window.setTimeout(function(){t._dropDown.hide();var n=t._calendar.getSelectedDate();t._dropDown.setText(e.formatDate(n)),t._fireSelectedDateChanged()},100)},_fireSelectedDateChanged:function(){var e,t=this;for(e=0;e<t._events.selectedDateChanged.length;++e)t._events.selectedDateChanged[e]()},getSelectedDate:function(){var e=this;return e._calendar.getSelectedDate()},setSelectedDate:function(t){var n=this;n._calendar.setSelectedDate(t),n._dropDown.setText(e.formatDate(t))},onSelectedDateChanged:function(e){var t=this;t._events.selectedDateChanged.push(e)},setEnabled:function(e){var t=this;t._dropDown.setEnabled(e)},isEnabled:function(){var e=this;return e._dropDown.isEnabled()},getElement:function(){var e=this;return e._el}},e.TimePicker=function(t){this._el=$(t?e.element(t):"<div></div>"),this._minuteDropDown=null,this._hourDropDown=null,this._events={selectedTimeChanged:[]},this._initControl()},e.TimePicker.prototype={_initControl:function(){var t,n,i,a,o=this,r=$('<div style="display:inline-block"></div>');for(o._minuteDropDown=new e.DropDownItemsList(r),t=0;12>t;++t)a=(5*t).toString(),1===a.length&&(a="0"+a),n=$('<div class="ns-TimePickerItem"></div>'),n.text(a),i=$('<div class="ns-TimePickerDisplayItem"></div>'),i.text(a),o._minuteDropDown.addItem(n,i);o._minuteDropDown.setSelectedIndex(0),o._minuteDropDown.onSelectedIndexChanged(function(){o._dropDown_SelectedIndexChanged()});var s=$('<div style="display: inline-block"></div>');for(o._hourDropDown=new e.DropDownItemsList(s),t=0;24>t;++t)a=t.toString(),1===a.length&&(a="0"+a),n=$('<div class="ns-TimePickerItem"></div>'),n.text(a),i=$('<div class="ns-TimePickerDisplayItem"></div>'),i.text(a),o._hourDropDown.addItem(n,i);o._hourDropDown.setSelectedIndex(0),o._hourDropDown.onSelectedIndexChanged(function(){o._dropDown_SelectedIndexChanged()});var l=$('<div class="ns-TimePickerSeparator"></div>');l.text(":"),o._el.append(s),o._el.append(l),o._el.append(r)},_dropDown_SelectedIndexChanged:function(){var e=this;e._fireSelectedTimeChanged()},_fireSelectedTimeChanged:function(){var e,t=this;for(e=0;e<t._events.selectedTimeChanged.length;++e)t._events.selectedTimeChanged[e]()},onSelectedTimeChanged:function(e){var t=this;t._events.selectedTimeChanged.push(e)},getSelectedTime:function(){var e=this,t=new Date(0,0,0,e._hourDropDown.getSelectedIndex(),5*e._minuteDropDown.getSelectedIndex());return t},setSelectedTime:function(e){var t=this;t._hourDropDown.setSelectedIndex(e.getHours());var n=Math.round(e.getMinutes()/5);n>=12&&(n=11),t._minuteDropDown.setSelectedIndex(n)},setEnabled:function(e){var t=this;t._hourDropDown.setEnabled(e),t._minuteDropDown.setEnabled(e)},isEnabled:function(){var e=this;return e._hourDropDown.isEnabled()},getElement:function(){var e=this;return e._el}},e.DateTimePicker=function(t){this._el=$(t?e.element(t):"<div></div>"),this._timePicker=null,this._datePicker=null,this._events={selectedDateChanged:[]},this._initControl()},e.DateTimePicker.prototype={_initControl:function(){var t=this,n=$('<div style="display: inline-block"></div>'),i=$('<div style="display: inline-block"></div>'),a=$('<div class="ns-DateTimePicker-Separator"></div>');t._datePicker=new e.DatePicker(n),t._datePicker.onSelectedDateChanged(function(){t._onSelectedDateChanged()}),t._timePicker=new e.TimePicker(i),t._timePicker.onSelectedTimeChanged(function(){t._onSelectedDateChanged()}),t._el.append(n),t._el.append(a),t._el.append(i)},_onSelectedDateChanged:function(){var e=this;e._fireSelectedDateChanged()},_fireSelectedDateChanged:function(){var e,t=this;for(e=0;e<t._events.selectedDateChanged.length;++e)t._events.selectedDateChanged[e]()},onSelectedDateChanged:function(e){var t=this;t._events.selectedDateChanged.push(e)},setSelectedDate:function(e){var t=this;t._datePicker.setSelectedDate(e),t._timePicker.setSelectedTime(e)},getSelectedDate:function(){var e=this,t=e._datePicker.getSelectedDate(),n=e._timePicker.getSelectedTime(),i=new Date(t.getFullYear(),t.getMonth(),t.getDate(),n.getHours(),n.getMinutes());return i},setEnabled:function(e){var t=this;t._datePicker.setEnabled(e),t._timePicker.setEnabled(e)},isEnabled:function(){var e=this;return e._datePicker.isEnabled()},getElement:function(){var e=this;return e._el}}}(PlatformUI),function(e){e.Dialog=function(t){this._content=$(t?e.element(t):"<div></div>"),this._wrapper=null,this._dialog=null,this._title=null,this._container=null,this._commandPanel=null,this._width=300,this._height=100,this._maximized=!1,this._init()},e.extend(e.Dialog,{_init:function(){var t=this,n=$('<div class="Background"></div>'),i=$('<div class="Dialog"></div>'),a=$('<h1 class="DialogTitle"></h1>');i.append(a);var o=$('<div class="Container"></div>');o.append(this._content),i.append(o);var r=$('<div class="CommandPanel"></div>');r.hide(),i.append(r);var s=$('<div class="PlatformUI-Control PlatformUI-Dialog"></div>');s.hide(),s.append(n),s.append(i),$(window).resize(function(){t._onWindowResize()}),$(e.body()).append(s),t._title=a,t._container=o,t._commandPanel=r,t._dialog=i,t._wrapper=s},setContentElement:function(t){var n=this;n._container.empty(),n._container.append(e.element(t))},getContentElement:function(){var e=this;return e._content},setTitle:function(e){var t=this;t._title.text(e)},getTitle:function(){var e=this;return e._title.text()},setSize:function(e,t){this._width=e,this._height=t,this._resizeIfVisible()},getWidth:function(){return this._width},getHeight:function(){return this._height},setContentSize:function(e,t){this._width=e,this._height=t+this._title.height()+this._commandPanel.height(),this._maximized=!1,this._resizeIfVisible()},getContentWidth:function(){return this._width},getContentHeight:function(){return this._height-this._title.height()-this._commandPanel.height()},addCommandElement:function(t){var n=this;n._commandPanel.append(e.element(t)),n._commandPanel.show()},_resizeIfVisible:function(){this._wrapper.is(":visible")&&this._resize()},_resize:function(){var e=this,t=e._dialog;t.width(e._width),t.height(e._height);var n=t.width(),i=t.height(),a=1.5*i;$(window).innerHeight()/2-a<150&&(a=$(window).innerHeight()/2-150),$(window).innerHeight()/2<i&&(a=i/2),t.css({"margin-left":-Math.round(n/2),"margin-top":-Math.round(a)})},_onWindowResize:function(){this._maximized&&this.maximize()},maximize:function(){this._maximized=!0,this._width=$(window).innerWidth()-50,this._height=$(window).innerHeight()-50,this._resizeIfVisible()},setScrollingEnabled:function(e){e?this._container.addClass("Scrollable"):this._container.removeClass("Scrollable")},show:function(){var t=this;t._wrapper.css("z-index",e.nextZIndex()),e.appear(t._wrapper,{start:function(){t._resize()}})},hide:function(){var t=this;e.disappear(t._wrapper)}})}(PlatformUI),function(e){e.ConfirmDialog=function(){e.ConfirmDialog.super.constructor.call(this);var t=this,n=$("<div></div>"),i=new e.Button;i.setText("ОК"),i.onClick(function(){t._onConfirm()});var a=new e.Button;a.setText("Отмена"),a.onClick(function(){t._onCancel()}),this._events={confirm:[],cancel:[]},this.setContentElement(n),this.addCommandElement(i),this.addCommandElement(a),this._text=n,this._yesButton=i,this._noButton=a},e.inherit(e.Dialog,e.ConfirmDialog,{_onConfirm:function(){var e;for(e=0;e<this._events.confirm.length;++e)this._events.confirm[e]()},_onCancel:function(){this.hide();var e;for(e=0;e<this._events.cancel.length;++e)this._events.cancel[e]()},setText:function(e){this._text.text(e)},getText:function(){return this._text.text()},setYesButtonText:function(e){this._yesButton.setText(e)},getYesButtonText:function(){return this._yesButton.getText()},setNoButtonText:function(e){this._noButton.setText(e)},getNoButtonText:function(){return this._noButton.getText()},onConfirm:function(e){this._events.confirm.push(e)},onCancel:function(e){this._events.cancel.push(e)}})}(PlatformUI),function(e){e.DeleteConfirmDialog=function(){e.DeleteConfirmDialog.super.constructor.call(this),this.setTitle("Удаление элемента"),this.setText("Вы уверены, что хотите удалить выбранный элемент?"),this.setContentSize(300,65)},e.inherit(e.ConfirmDialog,e.DeleteConfirmDialog,{})}(PlatformUI),function(e){e.DropDown=function(t,n){this._el=$(t?e.element(t):"<div></div>"),this._buttonEl=null,this._buttonTextEl=null,this._dropContainerEl=null,this._dropEl=n?$(e.element(n)):null,this._isShown=null,this._isCancelled=null,this._isEnabled=null,this._events={beforeShow:[],afterShow:[],beforeHide:[],afterHide:[]},this._initControl()},e.DropDown.prototype={_initControl:function(){var t=this;t._isEnabled=!0,t._buttonEl=$('<a href="javascript:void(0)" class="ns-DropDown-Button"></a>'),t._el.append(t._buttonEl),t._dropContainerEl=$('<div class="ns-DropDown-Popup" style="display:none"></div>'),t._dropEl&&t._dropContainerEl.append(t._dropEl),$(e.body()).append(t._dropContainerEl),t._dropContainerEl.mousedown(function(e){t._dropContainer_MouseDown(e)}),t._buttonEl.mousedown(function(e){t._button_MouseDown(e)}),e.body().addEventListener("mousedown",function(e){t._body_MouseDown(e)},!0)},_button_MouseDown:function(){var e=this;e._isShown?(e._hide(),e._isCancelled=!1):e._isEnabled&&e._show()},_dropContainer_MouseDown:function(){var e=this;e._isShown&&(e._isCancelled=!0)},_body_MouseDown:function(){var e=this;e._isShown&&window.setTimeout(function(){return e._isCancelled?void(e._isCancelled=!1):void e._hide()},50)},_fireOnBeforeShow:function(){var e,t=this;for(e=0;e<t._events.beforeShow.length;++e)t._events.beforeShow[e]()
},_fireOnAfterShow:function(){var e,t=this;for(e=0;e<t._events.afterShow.length;++e)t._events.afterShow[e]()},_fireOnBeforeHide:function(){var e,t=this;for(e=0;e<t._events.beforeHide.length;++e)t._events.beforeHide[e]()},_fireOnAfterHide:function(){var e,t=this;for(e=0;e<t._events.afterHide.length;++e)t._events.afterHide[e]()},_show:function(){var t=this;t._fireOnBeforeShow();var n=t._el.offset(),i=Math.round(n.left),a=t._el.outerHeight()+Math.round(n.top);t._dropContainerEl.css({"z-index":e.nextZIndex(),left:i,top:a,position:"absolute"}),e.appear(t._dropContainerEl),t._isShown=!0,t._isCancelled=!1,t._buttonEl.addClass("Selected"),t._fireOnAfterShow()},_hide:function(){var t=this;t._fireOnBeforeHide(),t._buttonEl.removeClass("Selected"),e.disappear(t._dropContainerEl),t._isShown=!1,t._fireOnAfterHide()},_setEnabled:function(e){var t=this;t._isEnabled=e,t._isEnabled?t._buttonEl.removeClass("Disabled"):t._buttonEl.addClass("Disabled")},setEnabled:function(e){var t=this;t._setEnabled(e)},isEnabled:function(){var e=this;return e._isEnabled},hide:function(){var e=this;e._hide()},setText:function(e){var t=this;t._buttonEl.empty(),t._buttonEl.text(e)},setTextElement:function(e){var t=this;t._buttonEl.empty(),t._buttonEl.append(e)},setDropDownElement:function(e){var t=this;t._dropEl=e,t._dropContainerEl.empty(),t._dropContainerEl.append(e)},getDropDownElement:function(){var e=this;return e._dropEl},onBeforeShow:function(e){var t=this;t._events.beforeShow.push(e)},onAfterShow:function(e){var t=this;t._events.afterShow.push(e)},onBeforeHide:function(e){var t=this;t._events.beforeHide.push(e)},onAfterHide:function(e){var t=this;t._events.afterHide.push(e)},getElement:function(){var e=this;return e._el}}}(PlatformUI),function(e){e.GridRowCreatedEventArgs=function(e,t,n){this._defaultPrevented=!1,this.sender=e,this.rowElement=t,this.dataItem=n},e.GridRowCreatedEventArgs.prototype={preventDefault:function(){this._defaultPrevented=!0},isDefaultPrevented:function(){return this._defaultPrevented}},e.GridCellCreatedEventArgs=function(e,t,n,i,a){this._defaultPrevented=!1,this.sender=e,this.rowElement=t,this.cellElement=n,this.column=i,this.dataItem=a},e.GridCellCreatedEventArgs.prototype={preventDefault:function(){this._defaultPrevented=!0},isDefaultPrevented:function(){return this._defaultPrevented}},e.GridCommandEventArgs=function(e,t,n,i,a){this.sender=e,this.rowElement=t,this.cellElement=n,this.column=i,this.dataItem=a},e.GridHelper={isCommandColumn:function(e){return void 0!==e.commandColumn},isDataColumn:function(e){return void 0!==e.dataColumn},getColumnName:function(e){return this.isDataColumn(e)?e.dataColumn.name:this.isCommandColumn(e)?e.commandColumn.name:null}},e.Grid=function(t){this._element=$(t?e.element(t):"<table></table>"),this._items=null,this._headerElement=null,this._bodyElement=null,this._columns=[],this._emptyDataText=null,this._dataSource=null,this._pagingEnabled=!1,this._sortingEnabled=!1,this._filteringEnabled=!1,this._sortingArgs={column:"",direction:e.SortDirection.Ascending},this._sortingButton=null,this._pagingArgs={index:1,size:10},this._filteringArgs={},this._events={pageIndexChanged:new Array,pageSizeChanged:new Array,itemsCountChanged:new Array,bodyRowCreated:new Array,bodyCellCreated:new Array,dataBinding:new Array,dataBound:new Array},this._initElements()},e.extend(e.Grid,{_initElements:function(){this._recreateHeaderRow(),this._element.addClass("PlatformUI-Control "+this._getCssClass())},_getCssClass:function(){return"PlatformUI-Grid"},_getColumns:function(){return this._columns},_recreateHeaderRow:function(){this._headerElement||(this._headerElement=$("<thead></thead>"),this._element.append(this._headerElement)),this._headerElement.empty();var e=this._createHeaderRows();this._headerElement.append(e)},_createHeaderRows:function(){var e,t=$(),n=this._getColumns(),i=$("<tr></tr>");for(e=0;e<n.length;++e)i.append(this._createHeaderCell(n[e]));if(t=t.add(i),this._filteringEnabled){var a=$("<tr></tr>");for(a.addClass("PlatformUI-Filter"),e=0;e<n.length;++e)a.append(this._createHeaderFilterCell(n[e]));t=t.add(a)}return t},_createHeaderCell:function(e){var t="";e.header&&(t=e.header);var n;if(this._sortingEnabled&&e.dataColumn&&e.dataColumn.sortable){var i=this,a=$('<a href="javascript:void(0)"><span></span><div class="SortIcon"></div></a>');$("span",a).append(t),a.click(function(){i._sortButton_OnClick($(this),e.dataColumn)}),n=a,e._sortingButton=a}else n=$("<span></span>"),n.append(t);var o=$("<th></th>");return"undefined"!=typeof e.width&&o.width(e.width),o.append(n),o},_createHeaderFilterCell:function(e){var t=$("<th></th>");if("undefined"!=typeof e.width&&t.width(e.width),!e.dataColumn||!e.dataColumn.filterable)return t;var n=this,i=$('<input type="text" />');return i.keyup(function(){n._filteringArgs[e.dataColumn.name]={mode:"contains",value:i.value},n.dataBind()}),t.append(i),t},_createBodyRow:function(t,n){var i,a,o,r,s=this._getColumns();for(i=0;i<s.length;++i)o=s[i],a=$("<td></td>"),r=new e.GridCellCreatedEventArgs(this,t,a,o,n),this._fireBodyCellCreated(r),r.isDefaultPrevented()||this._createBodyCell(t,a,n,o),t.append(a)},_createBodyCell:function(t,n,i,a){if("undefined"!=typeof a.horizontal&&n.css("text-align",a.horizontal),e.GridHelper.isDataColumn(a))n.append(e.value(i,a.dataColumn.name));else if(e.GridHelper.isCommandColumn(a)){var o=new e.GridCommandEventArgs(this,t,n,a,i),r=$('<a href="javascript:void(0)"></a>');r.append(a.commandColumn.title);var s=new e.Button(r);s.onClick(function(){a.commandColumn.handler(o)}),n.append(r)}},_fireBodyRowCreated:function(e){var t,n=this._events.bodyRowCreated;for(t=0;t<n.length;++t)n[t](e)},_fireBodyCellCreated:function(e){var t,n=this._events.bodyCellCreated;for(t=0;t<n.length;++t)n[t](e)},_firePageIndexChanged:function(){var e,t=this._events.pageIndexChanged;for(e=0;e<t.length;++e)t[e]()},_firePageSizeChanged:function(){var e,t=this._events.pageSizeChanged;for(e=0;e<t.length;++e)t[e]()},_fireItemsCountChanged:function(e){var t,n=this._events.itemsCountChanged;for(t=0;t<n.length;++t)n[t](e)},_fireDataBinding:function(){var e,t=this._events.dataBinding;for(e=0;e<t.length;++e)t[e]()},_fireDataBound:function(){var e,t=this._events.dataBound;for(e=0;e<t.length;++e)t[e]()},_sortButton_OnClick:function(t,n){this._sortingArgs.column===n.name?this._sortingArgs.direction===e.SortDirection.Ascending?(this._sortingArgs.direction=e.SortDirection.Descending,this._sortingButton.removeClass("SortAsc"),this._sortingButton.addClass("SortDesc")):(this._sortingArgs.direction=e.SortDirection.Ascending,this._sortingButton.removeClass("SortDesc"),this._sortingButton.addClass("SortAsc")):(this._sortingButton&&(this._sortingButton.removeClass("SortAsc"),this._sortingButton.removeClass("SortDesc")),this._sortingButton=t,this._sortingArgs.column=n.name,this._sortingArgs.direction=e.SortDirection.Ascending,this._sortingButton.addClass("SortAsc")),this.dataBind()},_clearBody:function(){this._bodyElement||(this._bodyElement=$("<tbody></tbody>"),this._element.append(this._bodyElement)),this._bodyElement.empty()},_createDataRows:function(t){if(t){var n,i,a,o;for(n=0;n<t.length;++n)i=t[n],a=$("<tr></tr>"),o=new e.GridRowCreatedEventArgs(this,a,i),this._fireBodyRowCreated(o),o.isDefaultPrevented()||this._createBodyRow(a,i),this._bodyElement.append(a)}},_createEmptyDataRow:function(){if(0!==this._getColumns().length){var e=this.getEmptyDataText();if(e){var t=$("<td></td>");t.attr("colspan",this._getColumns().length),t.append(e);var n=$("<tr></tr>");n.append(t),this._bodyElement.append(n)}}},_appendData:function(e){e.data&&e.data.length>0?this._createDataRows(e.data):this._createEmptyDataRow(),this._fireItemsCountChanged(e.count),this._fireDataBound()},_dataSource_OnRead:function(e){this._clearBody(),this._appendData(e)},addColumns:function(e){var t;for(t=0;t<e.length;++t)this._columns.push(e[t]);this._recreateHeaderRow(),this._clearBody()},addDataColumn:function(t,n){var i={dataColumn:{name:t}};e.apply(i,n),this._columns.push(i),this._recreateHeaderRow(),this._clearBody()},addCommandColumn:function(t,n,i,a){var o={commandColumn:{name:t,title:i,handler:a}};e.apply(o,n),this._columns.push(o),this._recreateHeaderRow(),this._clearBody()},setDataSource:function(e){this._dataSource=e},getDataSource:function(){return this._dataSource},setEmptyDataText:function(e){this._emptyDataText=e},getEmptyDataText:function(){return this._emptyDataText},setSortingEnabled:function(e){e!==this._sortingEnabled&&(this._sortingEnabled=e,this._recreateHeaderRow())},setDefaultSorting:function(t,n){this._sortingArgs.column=t,this._sortingArgs.direction=n;var i,a;for(i=0;i<this._columns.length;++i)a=this._columns[i],a.dataColumn&&a.dataColumn.name===t&&(this._sortingButton&&(this._sortingButton.removeClass("SortAsc"),this._sortingButton.removeClass("SortDesc")),this._sortingButton=a._sortingButton,this._sortingButton.addClass(n===e.SortDirection.Ascending?"SortAsc":"SortDesc"))},setPagingEnabled:function(e){this._pagingEnabled=e},setPageSize:function(e){this._pagingArgs.size=e,this._firePageSizeChanged()},setPageIndex:function(e){this._pagingArgs.index=e,this._firePageIndexChanged()},setFilteringEnabled:function(e){e!==this._filteringEnabled&&(this._filteringEnabled=e,this._recreateHeaderRow())},onBodyRowCreated:function(e){this._events.bodyRowCreated.push(e)},onBodyCellCreated:function(e){this._events.bodyCellCreated.push(e)},onDataBinding:function(e){this._events.dataBinding.push(e)},onDataBound:function(e){this._events.dataBound.push(e)},isSortingEnabled:function(){return this._sortingEnabled},dataBind:function(){var e=this._pagingEnabled?this._pagingArgs:null,t=this._sortingEnabled&&this._sortingArgs.column?this._sortingArgs:null,n=this._filteringEnabled?this._filteringArgs:null,i=this;this._fireDataBinding(),this._dataSource.read(function(e){i._dataSource_OnRead(e)},e,t,n)},getPageIndex:function(){return this._pagingArgs.index},getPageSize:function(){return this._pagingArgs.size},isPagingEnabled:function(){return this._pagingEnabled},onPageIndexChanged:function(e){this._events.pageIndexChanged.push(e)},onPageSizeChanged:function(e){this._events.pageSizeChanged.push(e)},onItemsCountChanged:function(e){this._events.itemsCountChanged.push(e)},getElement:function(){return this._element}})}(PlatformUI),function(e){e.FlatTreeGrid=function(t){e.FlatTreeGrid.super.constructor.call(this,t),this.addDataColumn("_upIcon"),this._idColumn=null,this._hierarchyColumn=null,this._hierarchyDataSource=null,this._parentId=0,this._rootText="Корневой элемент"},e.inherit(e.Grid,e.FlatTreeGrid,{_getCssClass:function(){return"PlatformUI-FlatTreeGrid"},_createBodyRow:function(t,n,i){var a,o,r,s,l=this._getColumns();for(a=0;a<l.length;++a)r=l[a],o=$("<td></td>"),s=new e.GridCellCreatedEventArgs(this,t,o,r,n),this._fireBodyCellCreated(s),s.isDefaultPrevented()||this._createBodyCell(t,o,n,r,i),t.append(o)},_createBodyCell:function(t,n,i,a,o){if("undefined"!=typeof a.horizontal&&n.css("text-align",a.horizontal),e.GridHelper.isDataColumn(a))if(a.dataColumn.name===this._hierarchyColumn){var r=this,s=$('<a href="javascript:void(0)">'+e.value(i,a.dataColumn.name)+"</a>");s.click(function(){r._parentId=e.value(i,r._idColumn),r.dataBind()}),n.append(s)}else o&&"_upIcon"===a.dataColumn.name?n.addClass("UpIcon"):n.append(e.value(i,a.dataColumn.name));else if(!o&&e.GridHelper.isCommandColumn(a)){var l=new e.GridCommandEventArgs(this,t,n,a,i),d=$('<a href="javascript:void(0)"></a>');d.append(a.commandColumn.title);var h=new e.Button(d);h.onClick(function(){a.commandColumn.handler(l)}),n.append(d)}},_createDataRows:function(t,n){if(t){var i,a,o,r;for(i=0;i<t.length;++i)a=t[i],o=$(n?'<tr class="HierarchyRow"></tr>':"<tr></tr>"),r=new e.GridRowCreatedEventArgs(this,o,a),this._fireBodyRowCreated(r),r.isDefaultPrevented()||this._createBodyRow(o,a,n),this._bodyElement.append(o)}},_dataSource_OnRead:function(e,t){this._clearBody(),this._createDataRows(e,!0),this._appendData(t)},dataBind:function(t){var n=this;null!==t&&void 0!==t&&(this._parentId=t),this._fireDataBinding(),this._hierarchyDataSource.read(function(t){var i={};e.setValue(i,n._idColumn,0),e.setValue(i,n._hierarchyColumn,n._rootText);var a,o=[i];for(a=0;a<t.data.length;++a)o.push(t.data[a]);var r=n._pagingEnabled?n._pagingArgs:null,s=n._sortingEnabled&&n._sortingArgs.column?n._sortingArgs:null,l=n._filteringEnabled?n._filteringArgs:null;n._dataSource.read(function(e){n._dataSource_OnRead(o,e)},r,s,l,{parentId:n._parentId})},null,null,null,{parentId:this._parentId})},setIdColumn:function(e){this._idColumn=e},getIdColumn:function(){return this._idColumn},setHierarchyColumn:function(e){this._hierarchyColumn=e},getHierarchyColumn:function(){return this._hierarchyColumn},setHierarchyDataSource:function(e){this._hierarchyDataSource=e},getHierarchyDataSource:function(){return this._hierarchyDataSource},setRootText:function(e){this._rootText=e},getRootText:function(){return this._rootText},getParentId:function(){return this._parentId}})}(PlatformUI),function(e){e.FlatTreeSelectDialog=function(e){this._config=e,this._dialog=null,this._grid=null,this._events={select:[]},this._selectedHierarchy=null,this._init()},PlatformUI.extend(e.FlatTreeSelectDialog,{_init:function(){this._initGrid(),this._initDialog()},_initGrid:function(){var e=this,t=new PlatformUI.FlatTreeGrid,n=new PlatformUI.RemoteDataSource(this._config.itemUrl),i=new PlatformUI.RemoteDataSource(this._config.hierarchyUrl);i.onPrepareResponse(function(t){e._onPrepareHierarchyResponse(t)}),t.setDataSource(n),t.setHierarchyDataSource(i),this._createGridColumns(t),t.setIdColumn(this._config.idField),t.setHierarchyColumn(this._config.displayField),t.setSortingEnabled(!0),t.setDefaultSorting(this._config.displayField,PlatformUI.SortDirection.Ascending),t.setEmptyDataText("Элементы не найдены."),t.setPagingEnabled(!0),t.setPageSize(8),this._grid=t},_initDialog:function(){var e=this,t=new PlatformUI.Button;t.setText("Выбрать"),t.onClick(function(){e._onSelect()});var n=new PlatformUI.Button;n.setText("Закрыть"),n.onClick(function(){e.hide()});var i=$('<div style="width: 600px; height: 330px; overflow: auto;"></div>'),a=$("<div></div>");i.append(a);var o=$('<div style="width: 600px; height: 300px; overflow: auto;"></div>');o.append(this._grid.getElement()),i.append(o);var a=new PlatformUI.Pager(this._grid,a),r=new PlatformUI.Dialog;r.setTitle(this._config.title),r.setContentElement(i),r.addCommandElement(t),r.addCommandElement(n),r.setContentSize(610,340),this._dialog=r},_createGridColumns:function(e){e.addColumns([{dataColumn:{name:this._config.displayField,sortable:!0},header:this._config.displayFieldHeader,width:"560px"}])},_onPrepareHierarchyResponse:function(e){this._selectedHierarchy=e.data.data},_fireOnSelect:function(){var e;for(e=0;e<this._events.select.length;++e)this._events.select[e]()},onSelect:function(e){this._events.select.push(e)},_onSelect:function(){this._fireOnSelect(),this.hide()},getSelectedHierarchy:function(){return this._selectedHierarchy},show:function(e){this._selectedItem=null,this._grid.dataBind(e),this._dialog.show()},hide:function(){this._dialog.hide()}})}(PlatformUI.ns("PlatformUI")),function(e){e.Breadcrumb=function(e){this._element=$(e?PlatformUI.element(e):"<div></div>"),this._dataSource=null,this._rootText="",this._displayField="name",this._selectedIndex=-1,this._events={select:[]},this._init()},e.extend(e.Breadcrumb,{_init:function(){this._element.addClass("PlatformUI-Control PlatformUI-Breadcrumb")},setRootText:function(e){this._rootText=e},getRootText:function(){return this._rootText},setDataSource:function(e){this._dataSource=e},getDataSource:function(){return _dataSource},setDisplayField:function(e){this._displayField=e},getDisplayField:function(){return this._displayField},dataBind:function(){var e=this;this._dataSource.read(function(t){e._element.empty(),e._createRootElement();var n;for(n=0;n<t.data.length;++n)e._createItemElement(t.data[n],n);e._select(t.data.length-1)})},_select:function(e){var t=this._element.children().eq(this._selectedIndex+1);t.removeClass("Selected"),this._selectedIndex=e;var n=this._element.children().eq(this._selectedIndex+1);n.addClass("Selected")},_createRootElement:function(){var e=this,t=$('<span class="Root"></span>'),n=$('<a href="javascript:void(0)"></a>');n.html(this._rootText),n.click(function(){e._select(-1),e._onItemClick(null)}),t.append(n),this._element.append(t)},_createItemElement:function(t,n){var i=this,a=$('<span class="Next"></span>'),o=$('<a href="javascript:void(0)"></a>');o.html(e.value(t,this._displayField)),o.click(function(){i._select(n),i._onItemClick(t)});var r=$("<span></span>");r.addClass("Item"+(n%2===1?" Alt":"")),r.append(a),r.append(o),this._element.append(r)},_onItemClick:function(e){this._fireOnSelect(e)},onSelect:function(e){this._events.select.push(e)},_fireOnSelect:function(e){var t;for(t=0;t<this._events.select.length;++t)this._events.select[t](e)}})}(PlatformUI.ns("PlatformUI")),function(e){e.ReferenceField=function(t){this._element=$(t?e.element(t):"<div></div>"),this._text=null,this._events={choose:[],cancel:[]},this._init()},e.extend(e.ReferenceField,{_init:function(){var e=this;this._element.addClass("PlatformUI-Control PlatformUI-ReferenceField");var t=$('<input type="text" readonly class="Input" />'),n=$('<a href="javascript:void(0)" class="ChooseButton">Выбрать</a>'),i=new PlatformUI.Button(n);i.onClick(function(){e._onChooseClick()});var a=$('<a href="javascript:void(0)" class="CancelButton">Отмена</a>'),o=new PlatformUI.Button(a);o.onClick(function(){e._onCancelClick()}),this._text=t,this._element.append(t),this._element.append(n),this._element.append(a)},_onChooseClick:function(){this._fireOnChoose()},_onCancelClick:function(){this._text.val(""),this._fireOnCancel()},onChoose:function(e){this._events.choose.push(e)},_fireOnChoose:function(){var e;for(e=0;e<this._events.choose.length;++e)this._events.choose[e]()},onCancel:function(e){this._events.cancel.push(e)},_fireOnCancel:function(){var e;for(e=0;e<this._events.cancel.length;++e)this._events.cancel[e]()},setWidth:function(e){this._text.width(e-150)},getWidth:function(){return this._text.width()+150},setText:function(e){this._text.val(e)},getText:function(){return this._text.val()}})}(PlatformUI.ns("PlatformUI")),function(e){e.ItemsList=function(t){this._containerEl=$(t?e.element(t):"<div></div>"),this._selectedIndex=-1,this._items=[],this._events={selectedIndexChanged:[]},this._initControl()},e.ItemsList.prototype={_initControl:function(){var e=this;e._containerEl.addClass("ns-ItemsList")},_fireOnSelectedIndexChanged:function(){var e,t=this;for(e=0;e<t._events.selectedIndexChanged.length;++e)t._events.selectedIndexChanged[e]()},setSelectedIndex:function(e){var t=this;if(-1!==t._selectedIndex&&t._items[t._selectedIndex].container.removeClass("Selected"),t._selectedIndex=e,-1!==e){var n=t._items[e].container;n.addClass("Selected"),t._containerEl[0].scrollIntoView(!0)}},getSelectedIndex:function(){var e=this;return e._selectedIndex},addItem:function(e){var t=this,n=$('<a href="javascript:void(0)" class="Item"></a>');n.append(e);var i=t._items.length;n.mouseover(function(){n.addClass("Highlighted")}),n.mouseout(function(){n.removeClass("Highlighted"),t._selectedIndex===i&&n.addClass("Selected")}),n.click(function(){-1!==t._selectedIndex&&t._items[t._selectedIndex].container.removeClass("Selected"),t._selectedIndex=i,t._items[t._selectedIndex].container.addClass("Selected"),t._fireOnSelectedIndexChanged()}),t._items.push({container:n,item:e}),t._containerEl.append(n)},removeItemAt:function(e){var t=this,n=t._items[e].container;n.remove(),t._items.splice(e,1),e===t._selectedIndex&&(t._selectedIndex=-1,t._fireOnSelectedIndexChanged())},clear:function(){var e=this;e._containerEl.empty(),e._items=[],e._selectedIndex=-1},getItemAt:function(e){var t=this;return t._items[e].item},onSelectedIndexChanged:function(e){var t=this;t._events.selectedIndexChanged.push(e)},getItemElementAt:function(e){var t=this;return t._containerEl.children()[e]},getElement:function(){var e=this;return e._containerEl}},e.DropDownItemsList=function(t){this._el=$(t?e.element(t):"<div></div>"),this._dropDown=null,this._itemsList=null,this._selectedIndex=-1,this._displayItems=[],this._initControl()},e.DropDownItemsList.prototype={_initControl:function(){var t=this,n=$('<div style="max-height: 200px; overflow-y: auto; overflow-x: hidden"></div>');t._itemsList=new e.ItemsList(n),t._dropDown=new e.DropDown(t._el,t._itemsList.getElement()),t._itemsList.onSelectedIndexChanged(function(){var e=t._itemsList.getSelectedIndex();t._selectedIndex=e,-1!==e?t._dropDown.setTextElement(t._displayItems[e]):t._dropDown.setText(""),t._dropDown.hide()}),t._dropDown.onBeforeShow(function(){t._itemsList.setSelectedIndex(t._selectedIndex)}),t._dropDown.onAfterShow(function(){-1!==t._selectedIndex&&(n.scrollTop=t._itemsList.getItemElementAt(t._selectedIndex).offsetTop)})},addItem:function(e,t){var n=this;n._displayItems.push(t?t:e.cloneNode(!0)),n._itemsList.addItem(e)},removeItemAt:function(e){var t=this;t._displayItems.splice(e,1),t._itemsList.removeItemAt(e)},onSelectedIndexChanged:function(e){var t=this;t._itemsList.onSelectedIndexChanged(e)},getSelectedIndex:function(){var e=this;return e._selectedIndex},setSelectedIndex:function(e){var t=this;t._selectedIndex=e,-1!==e?t._dropDown.setTextElement(t._displayItems[e]):t._dropDown.setText("")},setText:function(e){var t=this;t._dropDown.setText(e)},setTextElement:function(e){var t=this;t._dropDown.setTextElement(e)},setEnabled:function(e){var t=this;t._dropDown.setEnabled(e)},isEnabled:function(){var e=this;return e._dropDown.isEnabled()},show:function(){var e=this;e._dropDown.show()},hide:function(){var e=this;e._dropDown.hide()},getElement:function(){var e=this;return e._el}}}(PlatformUI),function(e){e.Pager=function(t,n){this._sectionSize=10,this._pagerEl=$(n?e.element(n):"<div></div>"),this._dataControl=t,this._prevPageIndex,this._prevPageSize,this._count=0,this._prevPageIndex=t.getPageIndex(),this._prevPageSize=t.getPageSize(),this._initElement(),this._createPager();var i=this;t.onPageIndexChanged(function(){i._dataControl_OnPageIndexChanged()}),t.onPageSizeChanged(function(){i._dataControl_OnPageSizeChanged()}),t.onItemsCountChanged(function(e){i._dataControl_OnItemsCountChanged(e)})},e.Pager.prototype={_initElement:function(){this._pagerEl.addClass("PlatformUI-Control PlatformUI-Pager")},_createPager:function(){if(this._pagerEl.empty(),this._dataControl.isPagingEnabled()){this._count<=0&&(this._count=1);var e=Math.ceil(this._count/this._prevPageSize),t=Math.floor(this._prevPageIndex/this._sectionSize)+(this._prevPageIndex%this._sectionSize>0?1:0),n=Math.ceil(e/this._sectionSize),i=this._prevPageIndex>1;this._pagerEl.append(this._createFirstPageButton(i));var a=t>1;this._pagerEl.append(this._createPrevSectionButton(a));var o,r,s=(t-1)*this._sectionSize+1,l=t*this._sectionSize;for(l>e&&(l=e),o=s;l>=o;++o)r=this._createPageElement(o),this._pagerEl.append(r);var d=n>t;this._pagerEl.append(this._createNextSectionButton(d));var h=this._prevPageIndex<e;this._pagerEl.append(this._createLastPageButton(h))}},_createPageElement:function(e){return e===this._prevPageIndex?this._createCurrentPageElement(e):this._createButtonPageElement(e)},_createCurrentPageElement:function(e){var t=$("<span></span>");return t.addClass("PlatformUI-Page PlatformUI-Selected"),t.append(e.toString()),t},_createButtonPageElement:function(e){var t=this,n=$('<a href="javascript:void(0)"></a>');n.append(e.toString()),n.click(function(){t._onPageButtonClick(e)});var i=$("<span></span>");return i.addClass("PlatformUI-Page"),i.append(n),i},_createFirstPageButton:function(e){var t,n=this;if(e){var i=$('<a href="javascript:void(0)"></a>');i.append("<<"),i.click(function(){n._onFirstPageClick()}),t=i}else t="<<";var a=$("<span></span>");return a.addClass("PlatformUI-Page"),a.append(t),a},_createLastPageButton:function(e){var t,n=this;if(e){var i=$('<a href="javascript:void(0)"></a>');i.append(">>"),i.click(function(){n._onLastPageClick()}),t=i}else t=">>";var a=$("<span></span>");return a.addClass("PlatformUI-Page"),a.append(t),a},_createPrevSectionButton:function(e){var t,n=this;if(e){var i=$('<a href="javascript:void(0)"></a>');i.append("<"),i.click(function(){n._onPrevSectionClick()}),t=i}else t="<";var a=$("<span></span>");return a.addClass("PlatformUI-Page"),a.append(t),a},_createNextSectionButton:function(e){var t,n=this;if(e){var i=$('<a href="javascript:void(0)"></a>');i.append(">"),i.click(function(){n._onNextSectionClick()}),t=i}else t=">";var a=$("<span></span>");return a.addClass("PlatformUI-Page"),a.append(t),a},_onPageButtonClick:function(e){this._dataControl.setPageIndex(e),this._dataControl.dataBind()},_onFirstPageClick:function(){this._dataControl.setPageIndex(1),this._dataControl.dataBind()},_onLastPageClick:function(){var e=Math.ceil(this._count/this._prevPageSize);this._dataControl.setPageIndex(e),this._dataControl.dataBind()},_onPrevSectionClick:function(){var e=Math.floor(this._prevPageIndex/this._sectionSize)+(this._prevPageIndex%this._sectionSize>0?1:0);if(!(1>=e)){var t=(e-1)*this._sectionSize;this._dataControl.setPageIndex(t),this._dataControl.dataBind()}},_onNextSectionClick:function(){var e=Math.ceil(this._count/this._prevPageSize),t=Math.floor(this._prevPageIndex/this._sectionSize)+(this._prevPageIndex%this._sectionSize>0?1:0),n=Math.ceil(e/this._sectionSize);t>=n||(this._dataControl.setPageIndex(t*this._sectionSize+1),this._dataControl.dataBind())},_dataControl_OnPageIndexChanged:function(){var e=this._dataControl.getPageIndex();e!==this._prevPageIndex&&(this._prevPageIndex=e,this._createPager())},_dataControl_OnPageSizeChanged:function(){var e=this._dataControl.getPageSize();e===this._prevPageSize&&(this._prevPageSize=e,this._createPager())},_dataControl_OnItemsCountChanged:function(e){e!==this._count&&(this._count=e,this._createPager())},getElement:function(){return this._pagerEl}}}(PlatformUI),function(e){e.TabContainer=function(t){this._tabContainerEl=$(t?e.element(t):"<div></div>"),this._tabStripEl=null,this._tabBodyEl=null,this._tabs=[],this._selectedIndex=-1,this._events={tabSelected:[]},this._initControl()},e.TabContainer.prototype={_initControl:function(){var e=this;e._tabContainerEl.addClass("ns-Control ns-TabContainer"),e._initTabStrip(),e._initTabBody()},_initTabStrip:function(){var e=this,t=$("<ul></ul>");t.addClass("ns-TabStrip"),e._tabContainerEl.append(t),e._tabStripEl=t},_createTabStripItem:function(e,t){var n=this,i=$("<li></li>"),a=$('<a href="javascript:void(0)"></a>');return a.click(function(){n._tabStripItem_Click(t)}),a.text(e),i.append(a),i},_initTabBody:function(){var e=this,t=$("<div></div>");t.addClass("ns-TabBody"),e._tabContainerEl.append(t),e._tabBodyEl=t},_createTabBodyItem:function(e){var t=$('<div style="display:none"></div>');return t.append(e),t},_selectTab:function(e){var t=this;-1!==t._selectedIndex&&(t._tabs[t._selectedIndex].tabStripItem.removeClass("ns-Selected"),t._tabs[t._selectedIndex].tabBodyItem.hide()),t._selectedIndex=e,t._tabs[t._selectedIndex].tabStripItem.addClass("ns-Selected"),t._tabs[t._selectedIndex].tabBodyItem.show()},_tabStripItem_Click:function(e){var t=this;t._selectTab(e),t._fireOnTabSelected(e)},_fireOnTabSelected:function(e){var t,n=this;for(t=0;t<n._events.tabSelected.length;++t)n._events.tabSelected[t](e)},addTab:function(t,n){var i=this,a=i._tabs.length,o=i._createTabStripItem(t,i._tabs.length),r=i._createTabBodyItem(e.element(n));i._tabStripEl.append(o),i._tabBodyEl.append(r),i._tabs.push({tabStripItem:o,tabBodyItem:r}),0===a&&i.selectTab(0)},removeTabAt:function(e){var t=this;t._tabs[e].tabStripItem.remove(),t._tabs[e].tabBodyItem.remove(),t._tabs.splice(e,1),t._selectedIndex===e&&(t._tabs.length>0?t.selectTab(0):t._selectedIndex=-1)},selectTab:function(e){var t=this;t._selectTab(e)},onTabSelected:function(e){var t=this;t._events.tabSelected.push(e)},getElement:function(){var e=this;return e._tabContainerEl}}}(PlatformUI);
//# sourceMappingURL=platformui.2.0.min.js.map